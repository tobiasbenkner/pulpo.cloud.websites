---
import { languages } from "@/lib/i18n";
import { getTranslatedPath } from "@/lib/registry";
import type { Language } from "@/lib/i18n";
import { Icon } from "astro-icon/components";

interface Props {
  lang: Language;
  routeKey: string;
}
const { lang, routeKey } = Astro.props;

const flagIcons: Record<Language, string> = {
  es: "circle-flags:es",
  en: "circle-flags:uk",
};

const labels: Record<Language, string> = {
  es: "ES",
  en: "EN",
};
---

<div class="flex items-center gap-2 md:gap-4">
  {
    languages.map((l) => {
      const isActive = l === lang;
      const href = getTranslatedPath(routeKey, l);

      return (
        <a
          href={href}
          hreflang={l}
          class:list={[
            "group flex items-center gap-2 rounded-full px-2 py-1 transition-all duration-300",
            isActive 
              ? "bg-surface/50 ring-1 ring-secondary/50" 
              : "hover:bg-surface/30 opacity-60 hover:opacity-100"
          ]}
          aria-label={`Switch to ${l}`}
        >
          <!-- Flagge -->
          <Icon 
            name={flagIcons[l]} 
            class:list={[
              "h-5 w-5 md:h-6 md:w-6 transition-all duration-300 rounded-full shadow-sm",
              isActive ? "grayscale-0 scale-110" : "grayscale opacity-80 group-hover:grayscale-0 group-hover:opacity-100"
            ]} 
          />
          
          <!-- Text Label -->
          <span
            class:list={[
              "text-xs font-bold tracking-widest uppercase",
              isActive ? "text-white" : "text-text-muted group-hover:text-white"
            ]}
          >
            {labels[l]}
          </span>
        </a>
      );
    })
  }
</div>