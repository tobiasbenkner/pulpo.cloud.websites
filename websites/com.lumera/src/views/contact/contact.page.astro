---
import type { ContactTranslations } from "./contact.i18n";
import type { Language } from "@/lib/i18n";
import { siteData } from "@/data/site";
import { Icon } from "astro-icon/components";

interface Props {
  lang: Language;
  t: ContactTranslations;
}

const { lang, t } = Astro.props;

const headingLines = t.hero.heading.split("\n");
const closingLines = t.closing.quote.split("\n");
const whatsappUrl = `https://wa.me/${siteData.contact.whatsapp.replace(/\D/g, "")}`;
---

<!-- Hero -->
<section
  class="flex items-center justify-center min-h-[70dvh] -mt-16 md:-mt-20 px-6 text-center"
>
  <div class="fade-in-section max-w-2xl">
    <h1 class="text-5xl sm:text-6xl md:text-7xl font-serif text-primary leading-tight">
      {headingLines.map((line, i) => (
        <Fragment>
          {i > 0 && <br />}
          {line}
        </Fragment>
      ))}
    </h1>
    <div class="mx-auto mt-8 w-12 border-t border-border"></div>
    <p class="mt-8 text-lg sm:text-xl text-text-muted max-w-lg mx-auto leading-relaxed">
      {t.hero.subheading}
    </p>
  </div>
</section>

<!-- CTAs -->
<section class="pb-24 sm:pb-32 px-6">
  <div class="max-w-xl mx-auto flex flex-col gap-5 fade-in-section">

    <!-- Email CTA -->
    <a
      href={`mailto:${siteData.contact.email}`}
      class="group relative flex items-center gap-5 rounded-lg border border-border bg-surface/50 px-6 py-5 transition-all duration-300 hover:border-secondary hover:bg-surface hover:shadow-md"
    >
      <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-secondary/10 text-secondary transition-colors duration-300 group-hover:bg-secondary group-hover:text-background">
        <Icon name="lucide:mail" class="h-5 w-5" />
      </div>
      <div class="flex-1 min-w-0">
        <span class="block text-base font-medium text-primary">
          {t.cta.email}
        </span>
        <span class="block text-sm text-text-muted mt-0.5">
          {t.cta.emailHint}
        </span>
      </div>
      <Icon
        name="lucide:arrow-right"
        class="h-5 w-5 text-text-muted transition-all duration-300 group-hover:text-secondary group-hover:translate-x-1"
      />
    </a>

    <!-- Instagram CTA -->
    <a
      href={siteData.social.instagram}
      target="_blank"
      rel="noopener noreferrer"
      class="group relative flex items-center gap-5 rounded-lg border border-border bg-surface/50 px-6 py-5 transition-all duration-300 hover:border-secondary hover:bg-surface hover:shadow-md"
    >
      <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-secondary/10 text-secondary transition-colors duration-300 group-hover:bg-secondary group-hover:text-background">
        <Icon name="lucide:instagram" class="h-5 w-5" />
      </div>
      <div class="flex-1 min-w-0">
        <span class="block text-base font-medium text-primary">
          {t.cta.instagram}
        </span>
        <span class="block text-sm text-text-muted mt-0.5">
          {t.cta.instagramHint}
        </span>
      </div>
      <Icon
        name="lucide:arrow-right"
        class="h-5 w-5 text-text-muted transition-all duration-300 group-hover:text-secondary group-hover:translate-x-1"
      />
    </a>

    <!-- WhatsApp CTA -->
    <a
      href={whatsappUrl}
      target="_blank"
      rel="noopener noreferrer"
      class="group relative flex items-center gap-5 rounded-lg border border-border bg-surface/50 px-6 py-5 transition-all duration-300 hover:border-secondary hover:bg-surface hover:shadow-md"
    >
      <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-secondary/10 text-secondary transition-colors duration-300 group-hover:bg-secondary group-hover:text-background">
        <Icon name="lucide:message-circle" class="h-5 w-5" />
      </div>
      <div class="flex-1 min-w-0">
        <span class="block text-base font-medium text-primary">
          {t.cta.whatsapp}
        </span>
        <span class="block text-sm text-text-muted mt-0.5">
          {t.cta.whatsappHint}
        </span>
      </div>
      <Icon
        name="lucide:arrow-right"
        class="h-5 w-5 text-text-muted transition-all duration-300 group-hover:text-secondary group-hover:translate-x-1"
      />
    </a>

  </div>
</section>

<!-- Closing Quote -->
<section class="py-24 sm:py-32 px-6 border-t border-border/50">
  <div class="max-w-2xl mx-auto text-center fade-in-section">
    <p class="font-serif italic text-xl sm:text-2xl md:text-3xl text-text-muted leading-relaxed">
      {closingLines.map((line, i) => (
        <Fragment>
          {i > 0 && <br />}
          {line}
        </Fragment>
      ))}
    </p>
  </div>
</section>

<script>
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("is-visible");
          observer.unobserve(entry.target);
        }
      });
    },
    { threshold: 0.15 }
  );

  document.querySelectorAll(".fade-in-section").forEach((el) => {
    observer.observe(el);
  });
</script>
