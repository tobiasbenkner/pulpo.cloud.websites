---
import Layout from "../layouts/Layout.astro";
import PageHeader from "../components/PageHeader.astro";
import { Icon } from "astro-icon/components";

const subscriptions = [
  {
    name: "Pulpo Estándar",
    price: "0€",
    period: "para siempre",
    desc: "La herramienta completa. Sin restricciones de funciones.",
    features: [
      "TPV + Web + Stock ilimitado",
      "Usuarios ilimitados",
      "Cumplimiento Verifactu",
      "Actualizaciones gratuitas",
      "Soporte: Documentación y Comunidad",
    ],
    highlight: false,
    btnText: "Registrarse Gratis",
    btnLink: "https://app.pulpo.com/register",
    icon: "heroicons:user",
  },
  {
    name: "Soporte Premium",
    price: "49€",
    period: "/mes",
    desc: "Para quien prefiere tener un técnico siempre disponible.",
    features: [
      "Todo lo incluido en Estándar",
      "Soporte prioritario por WhatsApp",
      "Asistencia remota (TeamViewer)",
      "Revisiones periódicas del sistema",
      "Resolución de dudas urgentes",
    ],
    highlight: true,
    btnText: "Contratar Soporte",
    btnLink: "/contacto",
    icon: "heroicons:lifebuoy",
  },
];

const oneTimeServices = [
  {
    title: "Puesta en Marcha",
    price: "Gratis",
    desc: "El sistema es auto-instalable. Siguiendo nuestras guías puedes tenerlo listo en 10 minutos sin coste.",
    icon: "heroicons:rocket-launch",
  },
  {
    title: "Migración de Productos",
    price: "100€",
    desc: "Pago único. Importamos tu base de datos actual (Excel, CSV) para que no tengas que teclear miles de productos.",
    icon: "heroicons:arrow-path-rounded-square",
  },
  {
    title: "Diseño Web a Medida",
    price: "500€",
    desc: "Pago único. Nuestros diseñadores crean una web única con tu imagen corporativa, sin usar plantillas.",
    icon: "heroicons:paint-brush",
  },
];

const comparisonCategories = [
  {
    category: "Costes y Licencias",
    rows: [
      {
        name: "Licencia de Software",
        pulpo: "0€ / mes",
        others: "40€ - 120€ / mes",
      },
      { name: "Comisión por venta (TPV)", pulpo: "0%", others: "0% - 2%" },
      { name: "Coste por actualización", pulpo: "0€", others: "Variable" },
      { name: "Permanencia", pulpo: "Ninguna", others: "12 meses" },
    ],
  },
  {
    category: "Funcionalidades",
    rows: [
      {
        name: "TPV Mostrador + Cocina",
        pulpo: true,
        others: "Módulo extra (€)",
      },
      {
        name: "Tienda Online sincronizada",
        pulpo: true,
        others: "Módulo extra (€)",
      },
      {
        name: "Número de Productos",
        pulpo: "Ilimitados",
        others: "Límite según plan",
      },
      {
        name: "Usuarios / Empleados",
        pulpo: "Ilimitados",
        others: "Cobran por usuario",
      },
      { name: "Gestión de Mesas (Plano)", pulpo: true, others: true },
    ],
  },
  {
    category: "Legal y Técnico",
    rows: [
      { name: "Normativa Verifactu", pulpo: true, others: "Depende versión" },
      { name: "Acceso al Código (Open Source)", pulpo: true, others: false },
      {
        name: "Compatible con cualquier Hardware",
        pulpo: true,
        others: "Solo su hardware",
      },
    ],
  },
];
---

<Layout title="Precios y Servicios - Pulpo">
  <PageHeader
    title="Software Libre, Servicios Profesionales"
    subtitle="Usa Pulpo gratis sin límites. Paga solo si necesitas ayuda o personalización."
  />

  <!-- 1. Subscription Plans -->
  <section class="py-20 max-w-6xl mx-auto px-4">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-pulpo-dark">Elige tu modalidad</h2>
      <p class="text-gray-600 mt-2">
        Empieza gratis. Añade tranquilidad cuando quieras.
      </p>
    </div>

    <div class="grid md:grid-cols-2 gap-8 items-start max-w-4xl mx-auto">
      {
        subscriptions.map((plan) => (
          <div
            class={`relative flex flex-col h-full p-8 rounded-2xl border transition-all duration-300 ${plan.highlight ? "border-pulpo-primary shadow-2xl bg-white scale-105 z-10" : "border-gray-200 bg-white hover:border-pulpo-primary/50 hover:shadow-lg"}`}
          >
            {plan.highlight && (
              <div class="absolute top-0 right-0 bg-pulpo-primary text-white text-xs font-bold px-4 py-1.5 rounded-bl-lg rounded-tr-lg uppercase tracking-wider">
                Recomendado
              </div>
            )}

            <div class="flex items-center gap-4 mb-6">
              <div
                class={`p-3 rounded-xl ${plan.highlight ? "bg-pulpo-surface-warm text-pulpo-primary" : "bg-gray-100 text-gray-600"}`}
              >
                <Icon name={plan.icon} class="w-8 h-8" />
              </div>
              <div>
                <h3 class="text-2xl font-bold text-gray-900">{plan.name}</h3>
              </div>
            </div>

            <p class="text-gray-600 mb-8 min-h-[50px]">{plan.desc}</p>

            <div class="mb-8 flex items-baseline gap-1">
              <span class="text-5xl font-extrabold text-pulpo-dark">
                {plan.price}
              </span>
              <span class="text-gray-500 font-medium text-lg">
                {plan.period}
              </span>
            </div>

            <div class="border-t border-gray-100 pt-8 mb-8 flex-1">
              <ul class="space-y-4">
                {plan.features.map((f) => (
                  <li class="flex items-start gap-3 text-gray-700">
                    <Icon
                      name="heroicons:check-circle"
                      class={`w-6 h-6 shrink-0 ${plan.highlight ? "text-pulpo-primary" : "text-pulpo-success"}`}
                    />
                    <span class="text-sm font-medium">{f}</span>
                  </li>
                ))}
              </ul>
            </div>

            <a
              href={plan.btnLink}
              class={`block w-full py-4 rounded-xl text-center font-bold text-lg transition shadow-md ${plan.highlight ? "bg-pulpo-primary text-white hover:bg-pulpo-primary-hover" : "bg-pulpo-dark text-white hover:bg-gray-800"}`}
            >
              {plan.btnText}
            </a>
            {plan.highlight ? (
              <p class="text-center text-xs text-gray-400 mt-4">
                Sin permanencia. Cancela cuando quieras.
              </p>
            ) : (
              <p class="text-center text-xs text-gray-400 mt-4">
                Registro inmediato. Sin tarjeta de crédito.
              </p>
            )}
          </div>
        ))
      }
    </div>
  </section>

  <!-- 2. One-Time Services -->
  <section class="py-20 bg-pulpo-surface border-y border-gray-200">
    <div class="max-w-6xl mx-auto px-4">
      <div class="text-center mb-16">
        <span class="text-pulpo-primary font-bold tracking-wider text-sm uppercase"
          >Servicios a la carta</span
        >
        <h2 class="text-3xl font-bold text-pulpo-dark mt-2">
          ¿Necesitas ayuda extra?
        </h2>
        <p class="text-gray-600 mt-2 max-w-2xl mx-auto">
          Si no tienes tiempo para configurar o quieres un resultado profesional
          llave en mano, contrata nuestros servicios puntuales. Pago único.
        </p>
      </div>

      <div class="grid md:grid-cols-3 gap-8">
        {
          oneTimeServices.map((service) => (
            <div class="bg-white p-8 rounded-2xl border border-gray-200 shadow-sm hover:shadow-md transition">
              <div class="flex justify-between items-start mb-6">
                <div class="bg-pulpo-surface-warm text-pulpo-primary p-3 rounded-lg">
                  <Icon name={service.icon} class="w-8 h-8" />
                </div>
                <!-- Badge Farbe angepasst: Wenn "Gratis", dann Success -->
                <div
                  class={`px-3 py-1 rounded-full text-sm font-bold ${service.price === "Gratis" ? "bg-pulpo-success-light text-pulpo-success" : "bg-gray-100 text-gray-700"}`}
                >
                  {service.price}
                </div>
              </div>
              <h3 class="text-xl font-bold text-gray-900 mb-3">
                {service.title}
              </h3>
              <p class="text-gray-600 text-sm leading-relaxed mb-6">
                {service.desc}
              </p>
              <a
                href="/contacto"
                class="text-pulpo-primary font-bold text-sm hover:underline flex items-center gap-1"
              >
                Solicitar información{" "}
                <Icon name="heroicons:arrow-right" class="w-4 h-4" />
              </a>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- 3. Detailed Comparison -->
  <section class="py-24 bg-white">
    <div class="max-w-5xl mx-auto px-4">
      <h2 class="text-3xl font-bold text-center mb-12">
        Comparativa Detallada
      </h2>

      <!-- MOBILE VIEW -->
     <div class="md:hidden mt-6">
        <div class="sticky top-16 z-40 grid grid-cols-2 text-xs uppercase tracking-wider bg-white border border-gray-200 rounded-t-xl shadow-md">
            <div class="py-3 text-center border-r border-gray-100 flex flex-col justify-center relative bg-white rounded-tl-xl">
                <span class="font-extrabold text-gray-900">Pulpo</span>
                <div class="absolute bottom-0 left-0 w-full h-[2px] bg-pulpo-primary"></div>
            </div>
            <div class="py-3 text-center flex flex-col justify-center bg-gray-50/50 rounded-tr-xl">
                <span class="font-semibold text-gray-400">Otros</span>
            </div>
        </div>

        <div class="border-x border-b border-gray-200 rounded-b-xl bg-white border-t-0">
            {comparisonCategories.map((cat, index) => (
                <div>
                    <div class={`bg-gray-100 text-gray-500 px-4 py-2 text-[10px] font-bold uppercase tracking-widest border-y border-gray-200 ${index === 0 ? 'border-t-0' : ''}`}>
                        {cat.category}
                    </div>
                    
                    <div class="divide-y divide-gray-100">
                        {cat.rows.map(row => (
                            <div class="flex flex-col bg-white">
                                <div class="px-2 pt-3 pb-1 text-xs font-bold text-gray-800 text-center leading-tight">
                                    {row.name}
                                </div>
                                <div class="grid grid-cols-2 text-sm pb-2">
                                    <div class="text-center py-1 px-1 border-r border-gray-100 flex items-center justify-center min-h-[30px]">
                                        {row.pulpo === true ? 
                                            <Icon name="heroicons:check-circle" class="w-6 h-6 text-pulpo-success" />
                                            : 
                                            <span class="font-bold text-gray-900 text-xs">{row.pulpo}</span>
                                        }
                                    </div>
                                    <div class="text-center py-1 px-1 flex items-center justify-center bg-gray-50/30">
                                        {row.others === true ? 
                                            <div class="opacity-60">
                                                <Icon name="heroicons:check" class="w-5 h-5 text-gray-500" />
                                            </div>
                                            : 
                                         row.others === false ? 
                                            <div class="flex items-center gap-1 opacity-60">
                                                <Icon name="heroicons:minus" class="w-4 h-4 text-gray-400" />
                                                <span class="text-[10px] font-medium text-gray-400 uppercase">No</span>
                                            </div>
                                            : 
                                            <span class="text-xs text-gray-500 font-medium">{row.others}</span>
                                        }
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            ))}
        </div>
    </div>

      <!-- DESKTOP VIEW -->
      <div
        class="hidden md:block overflow-hidden border border-gray-200 rounded-2xl shadow-lg"
      >
        <table class="w-full text-left border-collapse bg-white">
          <thead>
            <tr class="bg-gray-50">
              <th
                class="p-6 border-b border-gray-200 text-gray-500 font-medium w-1/2"
                >Características</th
              >
              <th
                class="p-6 border-b border-gray-200 text-pulpo-dark font-extrabold text-center text-xl w-1/4 bg-pulpo-surface-warm"
                >Pulpo</th
              >
              <th
                class="p-6 border-b border-gray-200 text-gray-400 font-medium text-center w-1/4"
                >Otros TPV</th
              >
            </tr>
          </thead>

          {
            comparisonCategories.map((cat, catIndex) => (
              <tbody class={catIndex !== 0 ? "border-t-2 border-gray-100" : ""}>
                <tr class="bg-gray-50/50">
                  <td
                    colspan="3"
                    class="px-6 py-3 text-xs font-bold uppercase tracking-wider text-gray-500"
                  >
                    {cat.category}
                  </td>
                </tr>

                {cat.rows.map((row) => (
                  <tr class="hover:bg-gray-50 transition-colors group">
                    <td class="p-4 px-6 border-b border-gray-100 font-medium text-gray-700 group-hover:text-pulpo-dark">
                      {row.name}
                    </td>
                    <td class="p-4 px-6 border-b border-gray-100 text-center bg-pulpo-surface-warm/30 font-semibold text-pulpo-dark">
                      {row.pulpo === true ? (
                        <Icon
                          name="heroicons:check-circle"
                          class="w-6 h-6 text-pulpo-success mx-auto"
                        />
                      ) : (
                        row.pulpo
                      )}
                    </td>
                    <td class="p-4 px-6 border-b border-gray-100 text-center text-gray-500">
                      {row.others === true ? (
                        <Icon
                          name="heroicons:check"
                          class="w-5 h-5 text-gray-400 mx-auto"
                        />
                      ) : row.others === false ? (
                        <Icon
                          name="heroicons:x-mark"
                          class="w-5 h-5 text-red-300 mx-auto"
                        />
                      ) : (
                        row.others
                      )}
                    </td>
                  </tr>
                ))}
              </tbody>
            ))
          }
        </table>
      </div>

      <div
        class="mt-8 p-6 bg-yellow-50 rounded-xl border border-yellow-100 flex gap-4 items-start"
      >
        <Icon
          name="heroicons:light-bulb"
          class="w-6 h-6 text-yellow-600 shrink-0 mt-1"
        />
        <div>
          <h4 class="font-bold text-yellow-800 text-sm">
            ¿Por qué somos gratis?
          </h4>
          <p class="text-yellow-700 text-sm mt-1">
            Creemos que el software básico debe ser accesible. Ganamos dinero
            cuando tu negocio crece y decides contratar servicios profesionales
            (soporte, diseño o consultoría). Es un modelo "Win-Win".
          </p>
        </div>
      </div>
    </div>
  </section>
</Layout>